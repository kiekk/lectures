## Distributed Relational Database

- Distributed Database가 핵심
- 트래픽이 증가함에 따라 scale-up에는 한계가 있으므로 scale-out을 고려해야 함
- 이 때 DB가 늘어나는데 데이터를 각 DB에 분산하기 위해서는 샤딩 기법이 필요하다.
- 샤딩 기법은 데이터베이스를 수평적으로 나누는 방법으로, 각 샤드가 독립적으로 작동할 수 있도록 한다.
    - 샤딩: 데이터를 여러 데이터베이스에 분산하여 저장하는 기술
    - 샤드: 샤딩된 각각의 데이터 단위
- 샤딩 기법에는 수직 샤딩(Vertical Sharding)과 수평 샤딩(Horizontal Sharding)이 있다.


### 샤딩 기법
- 수직 샤딩
    - 데이터를 수직으로 분할하는 방식 (컬럼 단위)
    - 각 샤드가 적은 수의 컬럼을 저장, 성능 및 공간 이점이 생긴다.
    - 하지만 데이터의 분리로 조인 또는 트랜잭션 관리가 복잡해질 수 있다.
    - 수직으로 분할되기 때문에 수평적 확장에 제한이 있다.
- 수평 샤딩
    - 데이터를 수평으로 분할하는 방식 (행 단위)
    - 각 샤드에 데이터가 분산 저장되므로 성능 및 공간 이점이 생긴다.
    - 하지만 데이터의 분리로 조인 또는 트랜잭션 관리가 복잡해질 수 있다.
    - 수평으로 분할되기 때문에 수평적 확장에 용이하다.

### 샤딩 종류
- Range-based Sharding(범위 기반 샤딩)
    - 데이터를 특정 값(Shard key)의 특정 범위에 따라 분할하는 기법
- Hash-based Sharding(해시 기반 샤딩)
    - 데이터를 특정 값(Shard key)의 해시값에 따라 분할하는 기법
- Directory-based Sharding(디렉토리 기반 샤딩)
    - 디렉토리를 이용하여 데이터가 저장된 샤드를 관리하는 기법 (매핑 테이블을 이용하여 각 데이터가 저장된 샤드를 관리한다.)


### 샤드의 종류 (데이터베이스의 확장성과 연관된 개념)
- 물리적 샤드 (Physical Shard)
    - DB가 물리적으로 분리된 경우, N개의 물리적 샤드를 가진다.
    - 샤드가 늘어날 경우 데이터 재배치 처리 및 client의 수정이 필요하다.
- 논리적 샤드 (Logical Shard)
    - 개념적으로 데이터를 분할하는 가상의 샤드가 있을 경우
    - client가 논리적 샤드에 요청을 보낼 때 어떤 물리적 샤드에 속해있는지 알아야 하기 때문에 이를 위한 라우팅이 필요하다.
    - 샤드가 늘어날 경우 데이터 재배치는 필요하지만 client 수정은 필요하지 않다.


### 데이터 복제
- 데이터 복제의 필요성: 고가용성(High Availability), 안정성, 성능
- Primary/Replica 데이터베이스로 구성
    - Primary DB: 쓰기 전용, 데이터 변경이 발생하는 DB
    - Replica DB: 읽기 전용, Primary DB의 데이터를 복제하여 읽기 전용으로 사용
- 데이터 복제 방식
  - Synchronous Replication(동기 복제)
    - 데이터의 일관성을 보장하지만 성능 저하가 발생할 수 있다.
  - Asynchronous Replication(비동기 복제)
    - 데이터의 일관성을 보장하지 않지만 성능 저하가 발생하지 않는다.

## 📂 추가로 학습할만한 키워드
- Quorum
- Split Brain
- Multi-Leader
- Collision
- Consensus
- Clock